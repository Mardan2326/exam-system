<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PDFè¯•å·æ¨¡æ‹Ÿè€ƒè¯•å™¨ - è½»é‡ç‰ˆ</title>
  
  <!-- ç™¾åº¦ç»Ÿè®¡ -->
  <script>
  var _hmt = _hmt || [];
  (function() {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?0460c5ba8a47f553cf931f618d9786d1";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  })();
  </script>
  <style>
    :root{font-family: system-ui,-apple-system,"PingFang SC","Microsoft YaHei",Arial;}
    body{margin:0;display:flex;flex-direction:column;gap:12px;height:100vh;padding:12px;background:#f5f7fa}
    main{flex:1;display:flex;flex-direction:column;gap:12px;overflow:hidden}
    header{display:flex;align-items:center;gap:12px}
    .controls{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
    .panel{background:#fff;padding:20px;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,0.04);border:1px solid #e8ecf0}
    .quiz-container{flex:1;overflow-y:auto}
    .quiz{display:flex;flex-direction:column;gap:10px}
    .question{padding:10px;border-radius:6px;border:1px solid #eef2ff}
    .question-text{margin:10px 0;line-height:1.6;font-size:16px}
    .options button{display:block;width:100%;margin:6px 0;padding:10px;border-radius:6px;border:1px solid #dbe7ff;background:#fff;cursor:pointer;text-align:left;transition:all 0.2s}
    .options button:hover{background:#f0f4ff}
    .options button.selected{background:#e6f0ff;border-color:#4a90e2}
    .options button.correct{background:#d4edda;border-color:#28a745}
    .options button.wrong{background:#f8d7da;border-color:#dc3545}
    footer{display:flex;gap:8px;align-items:center;padding-top:10px;border-top:1px solid #eee}
    .progress-bar{width:200px;height:20px;background:#eee;border-radius:10px;overflow:hidden;margin:0 10px}
    .progress-fill{height:100%;background:#4a90e2;transition:width 0.3s ease}
    .fixed-nav{position:fixed;bottom:20px;left:20px;z-index:1000;display:flex;gap:8px}
    .fixed-nav button{padding:10px 16px;background:#4a90e2;color:white;border:none;border-radius:6px;cursor:pointer;box-shadow:0 2px 8px rgba(0,0,0,0.2)}
    .fixed-nav button:hover{background:#357abd}
    .fixed-nav button:disabled{opacity:0.5;cursor:not-allowed;background:#ccc}
    button{padding:8px 16px;border-radius:6px;border:1px solid #ddd;background:#fff;cursor:pointer}
    button:hover{background:#f5f5f5}
    button:disabled{opacity:0.5;cursor:not-allowed}
    .file-upload{display:flex;align-items:center;gap:8px}
    .file-upload input[type="file"]{display:none}
    .file-upload label{padding:10px 20px;border-radius:8px;border:1px solid #5b8def;background:#5b8def;color:white;cursor:pointer;font-weight:500;transition:all 0.2s}
    .file-upload label:hover{background:#4a7dd9;border-color:#4a7dd9}
    .file-name{color:#666;font-size:14px}
    .tip{background:#fafbfc;border:1px solid #e1e4e8;padding:20px;border-radius:8px;margin-bottom:16px;line-height:1.8;color:#586069;display:flex;gap:24px}
    .tip strong{color:#24292e}
    .tip-left{flex:1;font-size:13px;line-height:1.6;display:grid;grid-template-columns:1fr 1fr;gap:0 20px}
    .tip-left > strong{grid-column:1 / -1;font-size:15px;margin-bottom:8px}
    .tip-left > button{grid-column:1 / -1;margin-top:8px}
    .tip-right{width:320px;border-left:1px solid #e1e4e8;padding-left:24px}
    
    /* åˆå§‹UIä¼˜åŒ– */
    #setupMode header h2{font-size:24px;color:#2c3e50;font-weight:600;margin:0}
    .ai-platforms{display:flex;flex-direction:column;gap:8px;margin-top:12px}
    .ai-platforms a{padding:8px 16px;background:#f6f8fa;color:#586069;border-radius:6px;text-decoration:none;font-size:13px;transition:all 0.2s;border:1px solid #e1e4e8;display:block}
    .ai-platforms a:hover{background:#e8ecf0;border-color:#d1d5da;color:#24292e}
    .copy-prompt-btn{margin-left:8px;padding:6px 14px;background:#6c757d;color:white;border:none;border-radius:6px;cursor:pointer;font-size:12px;transition:all 0.2s}
    .copy-prompt-btn:hover{background:#5a6268}
    #loadBtn{background:#28a745;color:white;border:1px solid #28a745;font-weight:500}
    #loadBtn:hover{background:#218838;border-color:#218838}
    #loadBtn:disabled{background:#e9ecef;border-color:#e9ecef;color:#adb5bd}
    #resetBtn{color:#6c757d;border-color:#6c757d}
    #resetBtn:hover{background:#6c757d;color:white}
    
    /* æ²‰æµ¸å¼è€ƒè¯•æ¨¡å¼ */
    .exam-mode{display:flex;gap:16px;height:100%;}
    .exam-content{flex:1;display:flex;flex-direction:column;}
    .exam-header{background:#fff;padding:16px;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.05);margin-bottom:16px;display:flex;justify-content:space-between;align-items:center;}
    .exam-header h3{margin:0;font-size:18px;color:#333;}
    .exam-timer{display:flex;align-items:center;gap:16px;font-size:16px;}
    .timer-display{font-size:24px;font-weight:bold;color:#d9534f;}
    .exam-main{flex:1;background:#fff;padding:24px;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.05);overflow-y:auto;position:relative;padding-bottom:80px;}
    
    /* å³ä¾§é¢˜ç›®å¯¼èˆª */
    .question-nav{width:280px;background:#fff;padding:16px;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.05);overflow-y:auto;}
    .nav-section{margin-bottom:20px;}
    .nav-section h4{margin:0 0 12px 0;font-size:14px;color:#666;display:flex;align-items:center;gap:8px;}
    .nav-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:8px;}
    .nav-item{width:40px;height:40px;border:2px solid #ddd;border-radius:6px;background:#fff;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:500;transition:all 0.2s;}
    .nav-item:hover{border-color:#4a90e2;background:#f0f4ff;}
    .nav-item.answered{background:#e6f0ff;border-color:#4a90e2;color:#4a90e2;}
    .nav-item.active{background:#4a90e2;border-color:#4a90e2;color:#fff;}
    .nav-item.wrong{background:#f8d7da;border-color:#dc3545;color:#dc3545;font-weight:bold;}
    .nav-legend{display:flex;gap:16px;margin-top:16px;padding-top:16px;border-top:1px solid #eee;font-size:12px;}
    .nav-legend-item{display:flex;align-items:center;gap:6px;}
    .nav-legend-box{width:16px;height:16px;border-radius:4px;border:2px solid #ddd;}
    .nav-legend-box.answered{background:#e6f0ff;border-color:#4a90e2;}
    .nav-legend-box.active{background:#4a90e2;border-color:#4a90e2;}
    
    .submit-btn{width:100%;padding:12px;background:#28a745;color:white;border:none;border-radius:6px;font-size:16px;font-weight:bold;cursor:pointer;margin-top:16px;}
    .submit-btn:hover{background:#218838;}
    .submit-btn:disabled{background:#ccc;cursor:not-allowed;}
    
    .hidden{display:none;}
    
    /* å›ºå®šåœ¨åº•éƒ¨çš„å¯¼èˆªæŒ‰é’® */
    .question-nav-btns{position:fixed;bottom:20px;left:20px;display:flex;gap:12px;z-index:100;}
    .question-nav-btns button{padding:12px 24px;background:#fff;border:2px solid #4a90e2;color:#4a90e2;border-radius:8px;font-size:16px;font-weight:500;cursor:pointer;box-shadow:0 4px 12px rgba(0,0,0,0.15);transition:all 0.2s;}
    .question-nav-btns button:hover{background:#4a90e2;color:#fff;transform:translateY(-2px);box-shadow:0 6px 16px rgba(0,0,0,0.2);}
    .question-nav-btns button:disabled{opacity:0.4;cursor:not-allowed;background:#e0e0e0;border-color:#ccc;color:#999;}
    .question-nav-btns button:disabled:hover{background:#e0e0e0;color:#999;transform:none;box-shadow:0 4px 12px rgba(0,0,0,0.15);}
    .question-nav-btns button.prev-btn{background:#6c757d;border-color:#6c757d;color:#fff;}
    .question-nav-btns button.prev-btn:hover{background:#5a6268;border-color:#5a6268;}
  </style>
</head>
<body>
  <main id="setupMode">
    <header>
      <h2>PDFè¯•å·æ¨¡æ‹Ÿè€ƒè¯•å™¨</h2>
    </header>

    <div class="panel controls">
      <div class="file-upload">
        <label for="jsonFile">é€‰æ‹©JSONæ–‡ä»¶</label>
        <input type="file" id="jsonFile" accept=".json">
        <span class="file-name" id="fileName">æœªé€‰æ‹©æ–‡ä»¶</span>
      </div>
      <button id="loadBtn" disabled>å¼€å§‹è€ƒè¯•</button>
      <button id="resetBtn">é‡ç½®</button>
      <label for="examDuration" style="margin-left: 16px;color:#586069">è€ƒè¯•æ—¶é•¿(åˆ†é’Ÿ):</label>
      <input type="number" id="examDuration" value="90" style="width: 60px;border:1px solid #e1e4e8;border-radius:6px;padding:6px">
    </div>

    <div class="panel quiz-container">
      <div class="tip">
        <div class="tip-left">
          <strong>ä½¿ç”¨æŒ‡å—</strong>
          <div>
            <strong>ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡ PDF è¯•å·</strong>
            <br>â€¢ ç¡®ä¿ PDF æ–‡ä»¶æ¸…æ™°å¯è¯»
            <br>â€¢ è¯•å·æ ¼å¼ï¼šå•é€‰é¢˜ã€å¤šé€‰é¢˜ã€åˆ¤æ–­é¢˜å‡å¯
            <br><br><strong>ç¬¬äºŒæ­¥ï¼šé€‰æ‹© AI å¹³å°</strong>
            <br>â€¢ ä»å³ä¾§åˆ—è¡¨é€‰æ‹©ä¸€ä¸ª AI å¹³å°
            <br>â€¢ æ¨èä½¿ç”¨æ™ºè°±AIã€é€šä¹‰åƒé—®ç­‰
            <br>â€¢ ç‚¹å‡»å¹³å°åç§°åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€
            <br><br><strong>ç¬¬ä¸‰æ­¥ï¼šä¸Šä¼  PDF å¹¶è·å– JSON</strong>
            <br>â€¢ åœ¨ AI å¹³å°ä¸Šä¼ ä½ çš„ PDF è¯•å·
            <br>â€¢ ç‚¹å‡»ä¸‹æ–¹"å¤åˆ¶æç¤ºè¯"æŒ‰é’®
            <br>â€¢ å°†æç¤ºè¯ç²˜è´´ç»™ AI
            <br>â€¢ ç­‰å¾… AI ç”Ÿæˆ JSON æ ¼å¼çš„é¢˜ç›®
          </div>
          <div>
            <strong>ç¬¬å››æ­¥ï¼šä¿å­˜ JSON æ–‡ä»¶</strong>
            <br>â€¢ AI ç”Ÿæˆå,å¤åˆ¶å®Œæ•´çš„ JSON å†…å®¹
            <br>â€¢ åœ¨ç”µè„‘ä¸Šæ–°å»ºæ–‡æœ¬æ–‡ä»¶(è®°äº‹æœ¬)
            <br>â€¢ ç²˜è´´ JSON å†…å®¹,ä¿å­˜ä¸º .json æ–‡ä»¶
            <br>â€¢ ä¾‹å¦‚ä¿å­˜ä¸º: è¯•å·.json
            <br><br><strong>ç¬¬äº”æ­¥ï¼šå¼€å§‹è€ƒè¯•</strong>
            <br>â€¢ ç‚¹å‡»"é€‰æ‹©JSONæ–‡ä»¶"ä¸Šä¼ åˆšæ‰ä¿å­˜çš„æ–‡ä»¶
            <br>â€¢ è®¾ç½®è€ƒè¯•æ—¶é•¿(é»˜è®¤90åˆ†é’Ÿ)
            <br>â€¢ ç‚¹å‡»"å¼€å§‹è€ƒè¯•"ç«‹å³å¼€å§‹ç­”é¢˜
            <br><br><strong>æ³¨æ„äº‹é¡¹</strong>
            <br>â€¢ AI æ— æ³•ç›´æ¥ç”Ÿæˆæ–‡ä»¶,éœ€æ‰‹åŠ¨ä¿å­˜
            <br>â€¢ æ–‡ä»¶æ‰©å±•åå¿…é¡»æ˜¯ .json
            <br>â€¢ å¯å‚è€ƒç¤ºä¾‹æ–‡ä»¶äº†è§£æ ¼å¼
          </div>
          <button id="copyPromptBtn" class="copy-prompt-btn">å¤åˆ¶æç¤ºè¯</button>
        </div>
        <div class="tip-right">
          <strong>æ¨èçš„ AI å¹³å°</strong>
          <div class="ai-platforms">
            <a href="https://chatglm.cn/" target="_blank">æ™ºè°±AI (GLM)</a>
            <a href="https://tongyi.aliyun.com/qianwen/" target="_blank">é€šä¹‰åƒé—®</a>
            <a href="https://yiyan.baidu.com/" target="_blank">æ–‡å¿ƒä¸€è¨€</a>
            <a href="https://www.doubao.com/" target="_blank">è±†åŒ… (Doubao)</a>
            <a href="https://xinghuo.xfyun.cn/" target="_blank">è®¯é£æ˜Ÿç«</a>
            <a href="https://kimi.moonshot.cn/" target="_blank">Kimi</a>
            <a href="https://www.tiangong.cn/" target="_blank">å¤©å·¥AI</a>
            <a href="https://yuanbao.tencent.com/" target="_blank">è…¾è®¯å…ƒå®</a>
          </div>
        </div>
      </div>
      <div id="status" style="color:#6a737d;font-size:14px">è¯·é€‰æ‹© JSON æ–‡ä»¶å¼€å§‹</div>
    </div>
  </main>

  <!-- æ²‰æµ¸å¼è€ƒè¯•æ¨¡å¼ -->
  <main id="examMode" class="hidden">
    <div class="exam-mode">
      <!-- å·¦ä¾§è€ƒè¯•å†…å®¹åŒº -->
      <div class="exam-content">
        <div class="exam-header">
          <h3 id="examTitle">ğŸ“– æ­£åœ¨è€ƒè¯•</h3>
          <div class="exam-timer">
            <span>â±ï¸ å‰©ä½™æ—¶é—´ï¼š</span>
            <span class="timer-display" id="examTimer">90:00</span>
          </div>
        </div>
        <div class="exam-main" id="examQuiz"></div>
      </div>
      
      <!-- å³ä¾§é¢˜ç›®å¯¼èˆªåŒº -->
      <div class="question-nav">
        <div id="navSingleSection" class="nav-section">
          <h4>ğŸ”µ å•é€‰é¢˜</h4>
          <div id="navSingle" class="nav-grid"></div>
        </div>
        <div id="navMultipleSection" class="nav-section">
          <h4>ğŸŸ  å¤šé€‰é¢˜</h4>
          <div id="navMultiple" class="nav-grid"></div>
        </div>
        <div id="navJudgeSection" class="nav-section">
          <h4>ğŸ”· åˆ¤æ–­é¢˜</h4>
          <div id="navJudge" class="nav-grid"></div>
        </div>
        
        <div class="nav-legend">
          <div class="nav-legend-item">
            <div class="nav-legend-box"></div>
            <span>æœªç­”</span>
          </div>
          <div class="nav-legend-item">
            <div class="nav-legend-box answered"></div>
            <span>å·²ç­”</span>
          </div>
          <div class="nav-legend-item" id="wrongLegend" style="display:none;">
            <div class="nav-legend-box" style="background:#f8d7da;border-color:#dc3545;"></div>
            <span>ç­”é”™</span>
          </div>
        </div>
        
        <button id="submitExamBtn2" class="submit-btn">ğŸ“ æäº¤è¯•å·</button>
      </div>
    </div>
  </main>

  <script>
  document.addEventListener('DOMContentLoaded', () => {
    const statusEl = document.getElementById('status');
    const fileNameEl = document.getElementById('fileName');
    const loadBtn = document.getElementById('loadBtn');
    const submitExamBtn2 = document.getElementById('submitExamBtn2');
    const timerEl = document.getElementById('examTimer');
    const durationInput = document.getElementById('examDuration');
    const copyPromptBtn = document.getElementById('copyPromptBtn');
    const setupMode = document.getElementById('setupMode');
    const examMode = document.getElementById('examMode');
    const examQuiz = document.getElementById('examQuiz');
    const navSingle = document.getElementById('navSingle');
    const navMultiple = document.getElementById('navMultiple');
    const navJudge = document.getElementById('navJudge');
    const navSingleSection = document.getElementById('navSingleSection');
    const navMultipleSection = document.getElementById('navMultipleSection');
    const navJudgeSection = document.getElementById('navJudgeSection');

    let jsonFile = null;
    let questionBank = [];
    let currentIndex = 0;
    let userAnswers = {};
    let examSubmitted = false;
    let timerInterval = null;

    // å¤åˆ¶æç¤ºè¯åŠŸèƒ½
    const promptText = `è¯·ä»”ç»†è¯†åˆ«è¿™ä¸ªPDFæ–‡ä»¶ä¸­çš„æ‰€æœ‰é¢˜ç›®ï¼Œå¹¶æŒ‰ç…§ä»¥ä¸‹JSONæ ¼å¼è¾“å‡ºï¼š

**é‡è¦ï¼šè‡ªåŠ¨è¯†åˆ«é¢˜å‹**
- å¦‚æœé¢˜ç›®æ˜ç¡®æ ‡æ³¨"å¤šé€‰é¢˜"ã€"å¤šé¡¹é€‰æ‹©"ã€"ï¼ˆå¤šé€‰ï¼‰"ç­‰ï¼Œè®¾ç½® "type": "multiple"ï¼Œç­”æ¡ˆä¸ºæ•°ç»„å¦‚ ["A", "C"]
- å¦‚æœé¢˜ç›®è¦æ±‚åˆ¤æ–­"æ­£ç¡®/é”™è¯¯"ã€"å¯¹/é”™"ã€"æ˜¯/å¦"ã€"True/False"ï¼Œè®¾ç½® "type": "judge"ï¼Œé€‰é¡¹ä¸º {"âœ“": "æ­£ç¡®", "âœ—": "é”™è¯¯"}ï¼Œç­”æ¡ˆä¸º "âœ“" æˆ– "âœ—"
- å…¶ä»–æƒ…å†µé»˜è®¤ä¸ºå•é€‰é¢˜ï¼Œè®¾ç½® "type": "single"ï¼Œç­”æ¡ˆä¸ºå­—ç¬¦ä¸²å¦‚ "A"

1. å•é€‰é¢˜æ ¼å¼ï¼š
[
  {
    "id": "1",
    "type": "single",
    "text": "é¢˜å¹²å†…å®¹",
    "options": {
      "A": "é€‰é¡¹A",
      "B": "é€‰é¡¹B",
      "C": "é€‰é¡¹C",
      "D": "é€‰é¡¹D"
    },
    "answer": "A",
    "explanation": "è¿™é“é¢˜çš„è§£æè¯´æ˜(å¯é€‰,å»ºè®®æ·»åŠ )"
  }
]

2. å¤šé€‰é¢˜æ ¼å¼ï¼ˆé¢˜ç›®ä¸­æœ‰"å¤šé€‰"ã€"å¤šé¡¹"ç­‰æ ‡è¯†ï¼‰ï¼š
[
  {
    "id": "2",
    "type": "multiple",
    "text": "ä»¥ä¸‹å“ªäº›æ˜¯ç¼–ç¨‹è¯­è¨€ï¼Ÿï¼ˆå¤šé€‰ï¼‰",
    "options": {
      "A": "Python",
      "B": "HTML",
      "C": "Java",
      "D": "CSS"
    },
    "answer": ["A", "C"]
  }
]

3. åˆ¤æ–­é¢˜æ ¼å¼ï¼ˆé¢˜ç›®è¦æ±‚åˆ¤æ–­å¯¹é”™ï¼‰ï¼š
[
  {
    "id": "3",
    "type": "judge",
    "text": "åœ°çƒæ˜¯åœ†å½¢çš„ã€‚",
    "options": {
      "âœ“": "æ­£ç¡®",
      "âœ—": "é”™è¯¯"
    },
    "answer": "âœ“"
  }
]

4. å¸¦å›¾ç‰‡çš„é¢˜ç›®ï¼ˆé€‚ç”¨äºæ‰€æœ‰é¢˜å‹ï¼‰ï¼š
- é¢˜å¹²å¸¦å›¾ï¼šæ·»åŠ  "image": "<base64ç¼–ç >"
- é€‰é¡¹å¸¦å›¾ï¼š{"text": "æè¿°", "image": "<base64>"}

âš ï¸ é‡è¦è¦æ±‚ï¼š
1. **å¿…é¡»æå–æ‰€æœ‰é¢˜ç›®**ï¼Œé€é¡µéå†ï¼Œä¸è¦åªè¿”å›å‰å‡ é“æˆ–ç¤ºä¾‹ï¼
2. é¢˜å·ä»1å¼€å§‹è¿ç»­ç¼–å·ï¼Œç¡®ä¿æ•°é‡å®Œæ•´
3. **é¢˜å‹è‡ªåŠ¨è¯†åˆ«**ï¼ˆéå¸¸é‡è¦ï¼‰ï¼š
   - çœ‹åˆ°"å¤šé€‰é¢˜"ã€"å¤šé¡¹é€‰æ‹©é¢˜"ã€"ï¼ˆå¤šé€‰ï¼‰"ç­‰ â†’ "type": "multiple"ï¼Œanswerç”¨æ•°ç»„
   - çœ‹åˆ°"åˆ¤æ–­é¢˜"ã€"å¯¹é”™é¢˜"ã€é€‰é¡¹æ˜¯"æ­£ç¡®/é”™è¯¯"ã€"å¯¹/é”™"ã€"âˆš/Ã—" â†’ "type": "judge"
   - çœ‹åˆ°"å•é€‰é¢˜"æˆ–æ™®é€šçš„ABCDé€‰é¡¹ â†’ "type": "single"
   - **ç‰¹åˆ«æ³¨æ„**ï¼šåˆ¤æ–­é¢˜çš„é€‰é¡¹å¿…é¡»ç»Ÿä¸€è½¬æ¢ä¸º {"âœ“": "æ­£ç¡®", "âœ—": "é”™è¯¯"}ï¼Œå³ä½¿PDFä¸­æ˜¯"å¯¹/é”™"ã€"âˆš/Ã—"ã€"T/F"ç­‰å½¢å¼
4. **ç­”æ¡ˆå¤„ç†**ï¼ˆéå¸¸é‡è¦ï¼‰ï¼š
   - **ä¼˜å…ˆæå–PDFä¸­çš„ç­”æ¡ˆ**ï¼šå¦‚æœPDFä¸­æ˜ç¡®æ ‡æ³¨äº†ç­”æ¡ˆï¼ˆå¦‚"ç­”æ¡ˆï¼šB"ã€"æ­£ç¡®ç­”æ¡ˆï¼šAã€C"ç­‰ï¼‰ï¼Œç›´æ¥æå–ä½¿ç”¨
   - **AIåˆ¤æ–­**ï¼šå¦‚æœPDFä¸­æ²¡æœ‰ç­”æ¡ˆï¼Œä½ éœ€è¦æ ¹æ®é¢˜ç›®å†…å®¹è¿ç”¨çŸ¥è¯†åˆ¤æ–­æ­£ç¡®ç­”æ¡ˆ
   - **è®¾ä¸ºnull**ï¼šåªæœ‰åœ¨é¢˜ç›®è¿‡äºä¸“ä¸šæˆ–å®Œå…¨æ— æ³•åˆ¤æ–­æ—¶ï¼Œæ‰è®¾ä¸ºnull
   - å¤šé€‰é¢˜ç­”æ¡ˆå¿…é¡»æ˜¯æ•°ç»„ï¼Œå¦‚ ["A", "C", "D"]
   - åˆ¤æ–­é¢˜ç­”æ¡ˆå¿…é¡»æ˜¯ "âœ“" æˆ– "âœ—"
5. **é¢˜ç›®è§£æ**ï¼ˆå¯é€‰ä½†æ¨èï¼‰ï¼š
   - **ä¼˜å…ˆæå–PDFè§£æ**ï¼šå¦‚æœPDFä¸­æœ‰é¢˜ç›®è§£æã€ç­”æ¡ˆè§£é‡Šï¼Œç›´æ¥æå–åˆ° "explanation" å­—æ®µ
   - **AIç”Ÿæˆç®€å•è§£æ**ï¼šå¦‚æœPDFä¸­æ²¡æœ‰è§£æï¼Œæ ¹æ®ç­”æ¡ˆç®€å•è¯´æ˜ç†ç”±ï¼ˆ1-2å¥è¯å³å¯ï¼‰
   - è§£æè¦ç®€æ˜æ‰¼è¦ï¼Œè¯´æ˜ä¸ºä»€ä¹ˆé€‰è¿™ä¸ªç­”æ¡ˆæˆ–å…³é”®çŸ¥è¯†ç‚¹
   - ç¤ºä¾‹ï¼š
     - "åŒ—äº¬æ˜¯ä¸­åäººæ°‘å…±å’Œå›½çš„é¦–éƒ½ã€‚"
     - "Pythonå’ŒJavaæ˜¯ç¼–ç¨‹è¯­è¨€ï¼Œè€ŒHTMLæ˜¯æ ‡è®°è¯­è¨€ï¼ŒCSSæ˜¯æ ·å¼è¡¨è¯­è¨€ã€‚"
     - "æ ¹æ®ç‰›é¡¿ç¬¬äºŒå®šå¾‹F=maï¼ŒåŠ›ç­‰äºè´¨é‡ä¹˜ä»¥åŠ é€Ÿåº¦ã€‚"
6. ä¿æŒé¢˜ç›®å’Œé€‰é¡¹çš„åŸæ–‡,ä¸è¦ç®€åŒ–æˆ–æ”¹å†™
6. **å›¾ç‰‡å¤„ç†**ï¼ˆéå¸¸é‡è¦ï¼‰ï¼š
   - **ä¼˜å…ˆæ–¹æ¡ˆ**ï¼šå¦‚æœå›¾ç‰‡æ˜¯æ–‡å­—ã€æ•°å­—ã€å…¬å¼ã€å›¾è¡¨ç­‰ï¼Œè¯·ç›´æ¥è¯†åˆ«å¹¶è½¬ä¸ºæ–‡å­—æè¿°
   - **æ¬¡é€‰æ–¹æ¡ˆ**ï¼šå¦‚æœæ˜¯å¤æ‚å›¾å½¢ã€ç…§ç‰‡ï¼Œå°è¯•ç”¨æ–‡å­—è¯¦ç»†æè¿°å›¾ç‰‡å†…å®¹
   - **æœ€åæ–¹æ¡ˆ**ï¼šå®åœ¨æ— æ³•ç”¨æ–‡å­—è¡¨è¾¾æ—¶ï¼Œæ‰ä½¿ç”¨ {"text": "å›¾ç‰‡æè¿°", "image": "base64ç¼–ç "}
   - **ä¸¥ç¦**åªå†™"[å›¾ç‰‡]"è€Œä¸åšä»»ä½•æè¿°æˆ–è¯†åˆ«ï¼
   
   ç¤ºä¾‹ï¼š
   - âŒ é”™è¯¯ï¼š"A": "[å›¾ç‰‡]"
   - âœ… æ­£ç¡®ï¼š"A": "é€‰é¡¹ä¸ºæ•°å­— 12345"
   - âœ… æ­£ç¡®ï¼š"A": "ä¸€ä¸ªçº¢è‰²çš„æ­£æ–¹å½¢"
   - âœ… æ­£ç¡®ï¼š"A": "å…¬å¼ï¼šxÂ² + yÂ² = rÂ²"
7. åªè¿”å›çº¯JSONæ•°ç»„ï¼Œä¸è¦\`\`\`json\`\`\`æ ‡è®°ï¼Œä¸è¦å…¶ä»–è¯´æ˜æ–‡å­—
8. æœ€åæ£€æŸ¥ï¼šç¡®è®¤é¢˜ç›®æ•°é‡æ˜¯å¦å®Œæ•´ï¼ˆä¾‹å¦‚ï¼šPDFæœ‰85é“é¢˜ï¼ŒJSONä¹Ÿå¿…é¡»æœ‰85æ¡ï¼‰

**é¢˜å‹è¯†åˆ«ç¤ºä¾‹**ï¼š
- "1. ä¸­å›½çš„é¦–éƒ½æ˜¯ï¼Ÿ" â†’ single
- "2.ï¼ˆå¤šé€‰ï¼‰ä»¥ä¸‹å“ªäº›æ˜¯..." â†’ multiple
- "3. åœ°çƒæ˜¯åœ†çš„ã€‚ï¼ˆåˆ¤æ–­å¯¹é”™ï¼‰" â†’ judge
- "4. ä¸‹åˆ—è¯´æ³•æ­£ç¡®çš„æ˜¯" â†’ single
- "5. [å¤šé¡¹é€‰æ‹©] åŒ…æ‹¬..." â†’ multiple

**å›¾ç‰‡é¢˜ç‰¹åˆ«æé†’**ï¼š
- å¦‚æœé€‰é¡¹æ˜¯æ•°å­—åºåˆ—ï¼Œç›´æ¥è¯†åˆ«æ•°å­—å†™å‡ºæ¥
- å¦‚æœé€‰é¡¹æ˜¯ç®€å•å›¾å½¢ï¼Œæè¿°å½¢çŠ¶ã€é¢œè‰²ã€å¤§å°
- å¦‚æœé€‰é¡¹æ˜¯å…¬å¼ï¼Œè¯†åˆ«å…¬å¼å†…å®¹
- åƒä¸‡ä¸è¦å·æ‡’åªå†™"[å›¾ç‰‡]"ï¼`;

    copyPromptBtn.onclick = async () => {
      try {
        await navigator.clipboard.writeText(promptText);
        const originalText = copyPromptBtn.innerHTML;
        copyPromptBtn.innerHTML = 'âœ… å·²å¤åˆ¶ï¼';
        copyPromptBtn.style.background = '#28a745';
        setTimeout(() => {
          copyPromptBtn.innerHTML = originalText;
          copyPromptBtn.style.background = '#6c757d';
        }, 2000);
      } catch (err) {
        alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶æç¤ºè¯ï¼');
        console.error('å¤åˆ¶å¤±è´¥:', err);
      }
    };

    function startTimer(duration, display) {
        let timer = duration, minutes, seconds;
        if (timerInterval) clearInterval(timerInterval);
        timerInterval = setInterval(function () {
            minutes = parseInt(timer / 60, 10);
            seconds = parseInt(timer % 60, 10);
            minutes = minutes < 10 ? "0" + minutes : minutes;
            seconds = seconds < 10 ? "0" + seconds : seconds;
            display.textContent = minutes + ":" + seconds;
            if (--timer < 0) {
                clearInterval(timerInterval);
                alert('æ—¶é—´åˆ°ï¼è¯•å·å°†è‡ªåŠ¨æäº¤ã€‚');
                if (!examSubmitted) {
                    examSubmitted = true;
                    showResult();
                }
            }
        }, 1000);
    }

    document.getElementById('jsonFile').onchange = (e) => {
      const file = e.target.files[0];
      if(file && file.name.endsWith('.json')){
        jsonFile = file;
        fileNameEl.textContent = file.name;
        loadBtn.disabled = false;
        submitExamBtn.disabled = true;
        statusEl.textContent = 'å·²é€‰æ‹©JSONæ–‡ä»¶ï¼Œç‚¹å‡»"å¼€å§‹è€ƒè¯•"';
        statusEl.style.color = '#666';
      } else {
        jsonFile = null;
        fileNameEl.textContent = 'æœªé€‰æ‹©æ–‡ä»¶';
        loadBtn.disabled = true;
        alert('è¯·é€‰æ‹©æœ‰æ•ˆçš„JSONæ–‡ä»¶ï¼');
      }
    };

    loadBtn.onclick = async () => {
      if(!jsonFile) { alert('è¯·å…ˆé€‰æ‹©JSONæ–‡ä»¶ï¼'); return; }
      
      statusEl.textContent = 'æ­£åœ¨åŠ è½½JSONæ–‡ä»¶...';
      loadBtn.disabled = true;
      
      try {
        const text = await jsonFile.text();
        const questions = JSON.parse(text);
        
        if (!Array.isArray(questions) || questions.length === 0) {
          throw new Error('JSONæ ¼å¼é”™è¯¯ï¼šå¿…é¡»æ˜¯éç©ºæ•°ç»„');
        }
        
        // åˆ‡æ¢åˆ°æ²‰æµ¸å¼è€ƒè¯•æ¨¡å¼
        setupMode.classList.add('hidden');
        examMode.classList.remove('hidden');
        
        // æ¸²æŸ“é¢˜ç›®
        renderQuiz(questions);
        
        // å¯åŠ¨è®¡æ—¶å™¨
        let examDuration = parseInt(durationInput.value, 10) * 60;
        if (isNaN(examDuration) || examDuration <= 0) {
          examDuration = 90 * 60;
        }
        startTimer(examDuration, timerEl);
        
      } catch(e) {
        alert(`åŠ è½½å¤±è´¥ï¼š${e.message}`);
        console.error(e);
        loadBtn.disabled = false;
      }
    };

    function renderQuiz(questions){
      questionBank = questions;
      userAnswers = {};
      currentIndex = 0;
      examSubmitted = false;
      
      // æ¸²æŸ“å¯¼èˆªæ 
      renderNav();
      
      // æ˜¾ç¤ºç¬¬ä¸€é¢˜
      if (questions.length > 0) {
        showQuestion(0);
      }
    }
    
    function renderNav(){
      const singleQuestions = [];
      const multipleQuestions = [];
      const judgeQuestions = [];
      
      questionBank.forEach((q, idx) => {
        const type = q.type || 'single';
        if(type === 'single') singleQuestions.push({...q, index: idx});
        else if(type === 'multiple') multipleQuestions.push({...q, index: idx});
        else if(type === 'judge') judgeQuestions.push({...q, index: idx});
      });
      
      // æ¸²æŸ“å•é€‰é¢˜å¯¼èˆª
      if(singleQuestions.length > 0){
        navSingleSection.style.display = 'block';
        navSingle.innerHTML = '';
        singleQuestions.forEach((q, i) => {
          const item = document.createElement('div');
          item.className = 'nav-item';
          item.textContent = i + 1;
          item.dataset.index = q.index;
          item.onclick = () => jumpToQuestion(q.index);
          navSingle.appendChild(item);
        });
      } else {
        navSingleSection.style.display = 'none';
      }
      
      // æ¸²æŸ“å¤šé€‰é¢˜å¯¼èˆª
      if(multipleQuestions.length > 0){
        navMultipleSection.style.display = 'block';
        navMultiple.innerHTML = '';
        multipleQuestions.forEach((q, i) => {
          const item = document.createElement('div');
          item.className = 'nav-item';
          item.textContent = i + 1;
          item.dataset.index = q.index;
          item.onclick = () => jumpToQuestion(q.index);
          navMultiple.appendChild(item);
        });
      } else {
        navMultipleSection.style.display = 'none';
      }
      
      // æ¸²æŸ“åˆ¤æ–­é¢˜å¯¼èˆª
      if(judgeQuestions.length > 0){
        navJudgeSection.style.display = 'block';
        navJudge.innerHTML = '';
        judgeQuestions.forEach((q, i) => {
          const item = document.createElement('div');
          item.className = 'nav-item';
          item.textContent = i + 1;
          item.dataset.index = q.index;
          item.onclick = () => jumpToQuestion(q.index);
          navJudge.appendChild(item);
        });
      } else {
        navJudgeSection.style.display = 'none';
      }
      
      updateNav();
    }
    
    function jumpToQuestion(index){
      currentIndex = index;
      showQuestion(index);
    }
    
    function updateNav(){
      // æ›´æ–°æ‰€æœ‰å¯¼èˆªé¡¹çš„çŠ¶æ€
      document.querySelectorAll('.nav-item').forEach(item => {
        const idx = parseInt(item.dataset.index);
        const q = questionBank[idx];
        
        // ç§»é™¤æ‰€æœ‰çŠ¶æ€
        item.classList.remove('answered', 'active', 'wrong');
        
        // æ·»åŠ å½“å‰é¢˜ç›®æ ‡è®°
        if(idx === currentIndex){
          item.classList.add('active');
        }
        // å¦‚æœå·²æäº¤ï¼Œæ ‡è®°ç­”é”™çš„é¢˜ç›®
        else if(examSubmitted && q.answer && userAnswers[q.id]){
          const isCorrect = checkAnswer(q, userAnswers[q.id]);
          if(!isCorrect){
            item.classList.add('wrong');
          } else if(userAnswers[q.id]){
            item.classList.add('answered');
          }
        }
        // æ·»åŠ å·²ç­”é¢˜æ ‡è®°
        else if(userAnswers[q.id]){
          item.classList.add('answered');
        }
      });
    }
    
    function checkAnswer(question, userAnswer){
      if(!question.answer) return false;
      if(Array.isArray(question.answer)){
        const userAns = Array.isArray(userAnswer) ? userAnswer.sort().join(',') : userAnswer;
        const correctAns = question.answer.sort().join(',');
        return userAns === correctAns;
      } else {
        const userAns = Array.isArray(userAnswer) ? userAnswer[0] : userAnswer;
        return userAns === question.answer;
      }
    }

    function showQuestion(index){
      currentIndex = index;
      const q = questionBank[index];
      examQuiz.innerHTML = '';
      const div = document.createElement('div');
      div.className = 'question';
      
      const questionType = q.type || 'single';
      let typeLabel = 'ğŸ”µ å•é€‰é¢˜';
      if(questionType === 'multiple') typeLabel = 'ğŸŸ  å¤šé€‰é¢˜';
      else if(questionType === 'judge') typeLabel = 'ğŸ”· åˆ¤æ–­é¢˜';
      
      div.innerHTML = `<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">
        <h3 style="margin:0;font-size:20px;">${typeLabel}</h3>
        <span style="color:#999;font-size:14px;">é¢˜ç›® ${index + 1} / ${questionBank.length}</span>
      </div>`;
      
      const questionTextDiv = document.createElement('div');
      questionTextDiv.className = 'question-text';
      questionTextDiv.textContent = q.text;
      div.appendChild(questionTextDiv);
      
      if(q.image){
        const imgDiv = document.createElement('div');
        imgDiv.style.margin = '16px 0';
        imgDiv.style.textAlign = 'center';
        const img = document.createElement('img');
        img.src = q.image;
        img.style.maxWidth = '100%';
        img.style.maxHeight = '400px';
        img.style.borderRadius = '8px';
        img.style.border = '1px solid #ddd';
        imgDiv.appendChild(img);
        div.appendChild(imgDiv);
      }
      
      if(questionType === 'multiple'){
        const multiTip = document.createElement('div');
        multiTip.style.color = '#ff6b6b';
        multiTip.style.fontSize = '14px';
        multiTip.style.marginTop = '12px';
        multiTip.style.padding = '8px 12px';
        multiTip.style.background = '#fff3f3';
        multiTip.style.borderRadius = '6px';
        multiTip.textContent = 'âš ï¸ å¤šé€‰é¢˜ï¼šè¯·é€‰æ‹©æ‰€æœ‰æ­£ç¡®é€‰é¡¹';
        div.appendChild(multiTip);
      }
      
      const opts = document.createElement('div');
      opts.className = 'options';
      opts.style.marginTop = '20px';
      
      for(const key in q.options){
        const optionData = q.options[key];
        const btn = document.createElement('button');
        
        if(typeof optionData === 'string'){
          btn.textContent = `${key}. ${optionData}`;
        } else if(typeof optionData === 'object' && optionData.text){
          btn.innerHTML = `${key}. ${optionData.text}`;
          if(optionData.image){
            const optImg = document.createElement('img');
            optImg.src = optionData.image;
            optImg.style.maxWidth = '200px';
            optImg.style.marginLeft = '10px';
            optImg.style.borderRadius = '4px';
            btn.appendChild(optImg);
          }
        }
        
        btn.disabled = examSubmitted;
        btn.onclick = () => {
          if(!examSubmitted){
            if(questionType === 'multiple'){
              if(!userAnswers[q.id]) userAnswers[q.id] = [];
              const idx = userAnswers[q.id].indexOf(key);
              if(idx > -1){
                userAnswers[q.id].splice(idx, 1);
              } else {
                userAnswers[q.id].push(key);
              }
              userAnswers[q.id].sort();
            } else {
              userAnswers[q.id] = key;
            }
            showQuestion(currentIndex);
            updateNav();
          }
        };
        
        if(questionType === 'multiple'){
          if(userAnswers[q.id] && userAnswers[q.id].includes(key)){
            btn.classList.add('selected');
          }
        } else {
          if(userAnswers[q.id] === key){
            btn.classList.add('selected');
          }
        }
        
        if(examSubmitted && q.answer){
          const correctAnswers = Array.isArray(q.answer) ? q.answer : [q.answer];
          const userAnswer = Array.isArray(userAnswers[q.id]) ? userAnswers[q.id] : [userAnswers[q.id]];
          
          if(correctAnswers.includes(key)){
            btn.classList.add('correct');
          } else if(userAnswer.includes(key)){
            btn.classList.add('wrong');
          }
        }
        
        opts.appendChild(btn);
      }
      div.appendChild(opts);
      
      if(examSubmitted && q.answer){
        const answerHint = document.createElement('div');
        answerHint.style.marginTop = '16px';
        answerHint.style.padding = '12px';
        answerHint.style.background = '#d4edda';
        answerHint.style.borderRadius = '6px';
        answerHint.style.color = '#155724';
        answerHint.style.fontSize = '15px';
        const answerText = Array.isArray(q.answer) ? q.answer.join(', ') : q.answer;
        answerHint.innerHTML = `<strong>âœ“ å‚è€ƒç­”æ¡ˆï¼š${answerText}</strong>`;
        div.appendChild(answerHint);
        
        // æ˜¾ç¤ºé¢˜ç›®è§£æ
        if(q.explanation){
          const explanationDiv = document.createElement('div');
          explanationDiv.style.marginTop = '12px';
          explanationDiv.style.padding = '12px';
          explanationDiv.style.background = '#e7f3ff';
          explanationDiv.style.borderLeft = '4px solid #2196f3';
          explanationDiv.style.borderRadius = '4px';
          explanationDiv.style.color = '#0d47a1';
          explanationDiv.style.fontSize = '14px';
          explanationDiv.style.lineHeight = '1.6';
          explanationDiv.innerHTML = `<strong>ğŸ’¡ é¢˜ç›®è§£æï¼š</strong><br>${q.explanation}`;
          div.appendChild(explanationDiv);
        }
      }
      
      // æ›´æ–°å›ºå®šåº•éƒ¨å¯¼èˆªæŒ‰é’®
      updateBottomNav(index);
      examQuiz.appendChild(div);
      updateNav();
    }
    
    function updateBottomNav(index){
      let navBtns = document.getElementById('fixedNavBtns');
      if(!navBtns){
        navBtns = document.createElement('div');
        navBtns.id = 'fixedNavBtns';
        navBtns.className = 'question-nav-btns';
        document.body.appendChild(navBtns);
      }
      
      navBtns.innerHTML = '';
      
      // å§‹ç»ˆæ˜¾ç¤ºä¸Šä¸€é¢˜æŒ‰é’®
      const prevBtn = document.createElement('button');
      prevBtn.className = 'prev-btn';
      prevBtn.textContent = 'â† ä¸Šä¸€é¢˜';
      prevBtn.disabled = index === 0;
      prevBtn.onclick = () => {
        if(index > 0) showQuestion(index - 1);
      };
      navBtns.appendChild(prevBtn);
      
      // å§‹ç»ˆæ˜¾ç¤ºä¸‹ä¸€é¢˜æŒ‰é’®
      const nextBtn = document.createElement('button');
      nextBtn.textContent = 'ä¸‹ä¸€é¢˜ â†’';
      nextBtn.disabled = index === questionBank.length - 1;
      nextBtn.onclick = () => {
        if(index < questionBank.length - 1) showQuestion(index + 1);
      };
      navBtns.appendChild(nextBtn);
    }



    document.getElementById('resetBtn').onclick = () => {
      if(!confirm('ç¡®å®šè¦é‡ç½®å¹¶è¿”å›é¦–é¡µå—ï¼Ÿ')) return;
      if (timerInterval) clearInterval(timerInterval);
      timerEl.textContent = '--:--';
      durationInput.disabled = false;
      questionBank = [];
      userAnswers = {};
      examSubmitted = false;
      currentIndex = 0;
      setupMode.classList.remove('hidden');
      examMode.classList.add('hidden');
      statusEl.textContent = 'å·²é‡ç½®ã€‚è¯·é‡æ–°é€‰æ‹©JSONæ–‡ä»¶ã€‚';
      statusEl.style.color = '#666';
    };
    
    submitExamBtn2.onclick = () => {
      if(examSubmitted) return;
      const unanswered = questionBank.filter(q => !userAnswers[q.id]);
      if(unanswered.length > 0){
        if(!confirm(`è¿˜æœ‰ ${unanswered.length} é“é¢˜æœªç­”ï¼Œç¡®å®šè¦æäº¤å—ï¼Ÿ`)) return;
      }
      examSubmitted = true;
      if(timerInterval) clearInterval(timerInterval);
      showResult();
    };
    
    function showResult(){
      let correct = 0;
      for(const q of questionBank){
        if(userAnswers[q.id] && q.answer){
          if(checkAnswer(q, userAnswers[q.id])){
            correct++;
          }
        }
      }
      const score = Math.round(correct / questionBank.length * 100);
      
      // æ˜¾ç¤ºé”™é¢˜å›¾ä¾‹
      const wrongLegend = document.getElementById('wrongLegend');
      if(wrongLegend) wrongLegend.style.display = 'flex';
      
      // æ›´æ–°å¯¼èˆªæ˜¾ç¤ºé”™é¢˜
      updateNav();
      
      alert(`ğŸ‰ è€ƒè¯•ç»“æŸï¼

æ€»é¢˜æ•°ï¼š${questionBank.length}
æ­£ç¡®æ•°ï¼š${correct}
æ­£ç¡®ç‡ï¼š${score}%`);
      showQuestion(0);
    }
  });
  </script>
</body>
</html>
